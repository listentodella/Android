# 双向通信：socketpair & binder
输入系统需要双向进程通信
* socketpair可以实现双向通信，但是只适用于线程间、或者具有亲缘关系的进程间通信（因为实质上他们是通过fd通信的）
* binder可以实现无亲缘进程间的通信，但是如果想实现双向通信，则client和server还得各自扮演server和client，过于复杂
### socketpair + binder，由socketpair实现双向通信，由binder来传输fd的对应关系
进程1 fd = open(..)最终得到一个整型值，但是进程2不能直接操作这个整型值（因为fd只是内核维护的文件的数组的一个下标）
```
struct task_struct -> files -> fdt -> **fd(即fd[]，每一项都对应一个fd）
```

## 使用binder传输文件句柄fd
* 假设app1 open file,得到fd1
* 通过binder驱动,根据fd1得到它对应的file结构体->files->fdt->fd[fd1]
* 从app2的files->fdt->fd[]中取出一个空项,让它指向该file,假设fd[fd2]-->file
* app1通过fd1,app2通过fd2,可以访问同一个文件